<!DOCTYPE html><html lang="zh-tw,en,default"><head><meta charset="utf-8"><meta name="X-UA-Compatible" content="IE=edge"><title> Network containers · ChihKang's Blog</title><meta name="description" content="Network containers - ChihKang Lin"><meta name="viewport" content="width=device-width, initial-scale=1"><link rel="short icon" href="/favicon.png"><link rel="stylesheet" href="/css/apollo.css"><link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Source+Sans+Pro:400,600" type="text/css"></head><body><div class="wrap"><header><a href="/" class="logo-link"><img src="/favicon.png"></a><ul class="nav nav-list"><li class="nav-list-item"><a href="/" target="_self" class="nav-list-link">HOME</a></li><li class="nav-list-item"><a href="/archives" target="_self" class="nav-list-link">ARCHIVES</a></li></ul></header><section class="container"><div class="post"><article class="post-block"><h1 class="post-title">Network containers</h1><div class="post-info">2016年8月31日</div><div class="post-content"><h3 id="Network-containers"><a href="#Network-containers" class="headerlink" title="Network containers"></a>Network containers</h3><p>If you are working your way through the user guide, you just built and ran a simple application. You&#x2019;ve also built in your own images. This section teaches you how to network your containers.</p>
<h3 id="Name-a-container"><a href="#Name-a-container" class="headerlink" title="Name a container"></a>Name a container</h3><p>You&#x2019;ve already seen that each container you create has an automatically created name; indeed you&#x2019;ve become familiar with our old friend <code>nostalgic_morse</code> during this guide.</p>
<p>You can also name containers yourself. This naming provides two useful functions:</p>
<ol>
<li><p>You can name containers that do specific functions in a way that makes it easier for you to remember them, for example naming a container containing a web application <code>web</code>.</p>
</li>
<li><p>Names provide Docker with a reference point that allows it to refer to other containers. There are several commands that support this and you&#x2019;ll use one in an exercise later.</p>
</li>
</ol>
<p>You name your container by using the <code>--name</code> flag, for example launch a new container called web:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">$ docker run -d -P --name web training/webapp python app.py</div></pre></td></tr></table></figure>
<p>Use the <code>docker ps</code> command to check the name:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">PS C:\Users\Lin&gt; docker ps -l</div><div class="line">CONTAINER ID        IMAGE               COMMAND             CREATED             STATUS              PORTS                     NAMES</div><div class="line">0b1e85dd85c6        training/webapp     &quot;python app.py&quot;     2 minutes ago       Up 2 minutes        0.0.0.0:32768-&gt;5000/tcp   web</div></pre></td></tr></table></figure>
<p>You can also use <code>docker inspect</code> with the container&#x2019;s name.</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div><div class="line">85</div><div class="line">86</div><div class="line">87</div><div class="line">88</div><div class="line">89</div><div class="line">90</div><div class="line">91</div><div class="line">92</div><div class="line">93</div><div class="line">94</div><div class="line">95</div><div class="line">96</div><div class="line">97</div><div class="line">98</div><div class="line">99</div><div class="line">100</div><div class="line">101</div><div class="line">102</div><div class="line">103</div><div class="line">104</div><div class="line">105</div><div class="line">106</div><div class="line">107</div><div class="line">108</div><div class="line">109</div><div class="line">110</div><div class="line">111</div><div class="line">112</div><div class="line">113</div><div class="line">114</div><div class="line">115</div><div class="line">116</div><div class="line">117</div><div class="line">118</div><div class="line">119</div><div class="line">120</div><div class="line">121</div><div class="line">122</div><div class="line">123</div><div class="line">124</div><div class="line">125</div><div class="line">126</div><div class="line">127</div><div class="line">128</div><div class="line">129</div><div class="line">130</div><div class="line">131</div><div class="line">132</div><div class="line">133</div><div class="line">134</div><div class="line">135</div><div class="line">136</div><div class="line">137</div><div class="line">138</div><div class="line">139</div><div class="line">140</div><div class="line">141</div><div class="line">142</div><div class="line">143</div><div class="line">144</div><div class="line">145</div><div class="line">146</div><div class="line">147</div><div class="line">148</div><div class="line">149</div><div class="line">150</div><div class="line">151</div><div class="line">152</div><div class="line">153</div><div class="line">154</div><div class="line">155</div><div class="line">156</div><div class="line">157</div><div class="line">158</div><div class="line">159</div><div class="line">160</div><div class="line">161</div><div class="line">162</div><div class="line">163</div><div class="line">164</div><div class="line">165</div><div class="line">166</div><div class="line">167</div><div class="line">168</div><div class="line">169</div><div class="line">170</div><div class="line">171</div><div class="line">172</div><div class="line">173</div><div class="line">174</div><div class="line">175</div><div class="line">176</div><div class="line">177</div></pre></td><td class="code"><pre><div class="line">PS C:\Users\Lin&gt; docker inspect web</div><div class="line">[</div><div class="line">    {</div><div class="line">        &quot;Id&quot;: &quot;0b1e85dd85c656139beb4c914ac88124b4a0fe6842332475b30a2d7bc863212a&quot;,</div><div class="line">        &quot;Created&quot;: &quot;2016-08-31T15:22:30.6081431Z&quot;,</div><div class="line">        &quot;Path&quot;: &quot;python&quot;,</div><div class="line">        &quot;Args&quot;: [</div><div class="line">            &quot;app.py&quot;</div><div class="line">        ],</div><div class="line">        &quot;State&quot;: {</div><div class="line">            &quot;Status&quot;: &quot;running&quot;,</div><div class="line">            &quot;Running&quot;: true,</div><div class="line">            &quot;Paused&quot;: false,</div><div class="line">            &quot;Restarting&quot;: false,</div><div class="line">            &quot;OOMKilled&quot;: false,</div><div class="line">            &quot;Dead&quot;: false,</div><div class="line">            &quot;Pid&quot;: 7315,</div><div class="line">            &quot;ExitCode&quot;: 0,</div><div class="line">            &quot;Error&quot;: &quot;&quot;,</div><div class="line">            &quot;StartedAt&quot;: &quot;2016-08-31T15:22:31.3836079Z&quot;,</div><div class="line">            &quot;FinishedAt&quot;: &quot;0001-01-01T00:00:00Z&quot;</div><div class="line">        },</div><div class="line">        &quot;Image&quot;: &quot;sha256:6fae60ef344644649a39240b94d73b8ba9c67f898ede85cf8e947a887b3e6557&quot;,</div><div class="line">        &quot;ResolvConfPath&quot;: &quot;/var/lib/docker/containers/0b1e85dd85c656139beb4c914ac88124b4a0fe6842332475b30a2d7bc863212a/resolv.conf&quot;,</div><div class="line">        &quot;HostnamePath&quot;: &quot;/var/lib/docker/containers/0b1e85dd85c656139beb4c914ac88124b4a0fe6842332475b30a2d7bc863212a/hostname&quot;,</div><div class="line">        &quot;HostsPath&quot;: &quot;/var/lib/docker/containers/0b1e85dd85c656139beb4c914ac88124b4a0fe6842332475b30a2d7bc863212a/hosts&quot;,</div><div class="line">        &quot;LogPath&quot;: &quot;/var/lib/docker/containers/0b1e85dd85c656139beb4c914ac88124b4a0fe6842332475b30a2d7bc863212a/0b1e85dd85c656139beb4c914ac88124b4a0fe6842332475b30a2d7bc863212a-json.log&quot;,</div><div class="line">        &quot;Name&quot;: &quot;/web&quot;,</div><div class="line">        &quot;RestartCount&quot;: 0,</div><div class="line">        &quot;Driver&quot;: &quot;aufs&quot;,</div><div class="line">        &quot;MountLabel&quot;: &quot;&quot;,</div><div class="line">        &quot;ProcessLabel&quot;: &quot;&quot;,</div><div class="line">        &quot;AppArmorProfile&quot;: &quot;&quot;,</div><div class="line">        &quot;ExecIDs&quot;: null,</div><div class="line">        &quot;HostConfig&quot;: {</div><div class="line">            &quot;Binds&quot;: null,</div><div class="line">            &quot;ContainerIDFile&quot;: &quot;&quot;,</div><div class="line">            &quot;LogConfig&quot;: {</div><div class="line">                &quot;Type&quot;: &quot;json-file&quot;,</div><div class="line">                &quot;Config&quot;: {}</div><div class="line">            },</div><div class="line">            &quot;NetworkMode&quot;: &quot;default&quot;,</div><div class="line">            &quot;PortBindings&quot;: {},</div><div class="line">            &quot;RestartPolicy&quot;: {</div><div class="line">                &quot;Name&quot;: &quot;no&quot;,</div><div class="line">                &quot;MaximumRetryCount&quot;: 0</div><div class="line">            },</div><div class="line">            &quot;AutoRemove&quot;: false,</div><div class="line">            &quot;VolumeDriver&quot;: &quot;&quot;,</div><div class="line">            &quot;VolumesFrom&quot;: null,</div><div class="line">            &quot;CapAdd&quot;: null,</div><div class="line">            &quot;CapDrop&quot;: null,</div><div class="line">            &quot;Dns&quot;: [],</div><div class="line">            &quot;DnsOptions&quot;: [],</div><div class="line">            &quot;DnsSearch&quot;: [],</div><div class="line">            &quot;ExtraHosts&quot;: null,</div><div class="line">            &quot;GroupAdd&quot;: null,</div><div class="line">            &quot;IpcMode&quot;: &quot;&quot;,</div><div class="line">            &quot;Cgroup&quot;: &quot;&quot;,</div><div class="line">            &quot;Links&quot;: null,</div><div class="line">            &quot;OomScoreAdj&quot;: 0,</div><div class="line">            &quot;PidMode&quot;: &quot;&quot;,</div><div class="line">            &quot;Privileged&quot;: false,</div><div class="line">            &quot;PublishAllPorts&quot;: true,</div><div class="line">            &quot;ReadonlyRootfs&quot;: false,</div><div class="line">            &quot;SecurityOpt&quot;: null,</div><div class="line">            &quot;UTSMode&quot;: &quot;&quot;,</div><div class="line">            &quot;UsernsMode&quot;: &quot;&quot;,</div><div class="line">            &quot;ShmSize&quot;: 67108864,</div><div class="line">            &quot;Runtime&quot;: &quot;runc&quot;,</div><div class="line">            &quot;ConsoleSize&quot;: [</div><div class="line">                48,</div><div class="line">                188</div><div class="line">            ],</div><div class="line">            &quot;Isolation&quot;: &quot;&quot;,</div><div class="line">            &quot;CpuShares&quot;: 0,</div><div class="line">            &quot;Memory&quot;: 0,</div><div class="line">            &quot;CgroupParent&quot;: &quot;&quot;,</div><div class="line">            &quot;BlkioWeight&quot;: 0,</div><div class="line">            &quot;BlkioWeightDevice&quot;: null,</div><div class="line">            &quot;BlkioDeviceReadBps&quot;: null,</div><div class="line">            &quot;BlkioDeviceWriteBps&quot;: null,</div><div class="line">            &quot;BlkioDeviceReadIOps&quot;: null,</div><div class="line">            &quot;BlkioDeviceWriteIOps&quot;: null,</div><div class="line">            &quot;CpuPeriod&quot;: 0,</div><div class="line">            &quot;CpuQuota&quot;: 0,</div><div class="line">            &quot;CpusetCpus&quot;: &quot;&quot;,</div><div class="line">            &quot;CpusetMems&quot;: &quot;&quot;,</div><div class="line">            &quot;Devices&quot;: [],</div><div class="line">            &quot;DiskQuota&quot;: 0,</div><div class="line">            &quot;KernelMemory&quot;: 0,</div><div class="line">            &quot;MemoryReservation&quot;: 0,</div><div class="line">            &quot;MemorySwap&quot;: 0,</div><div class="line">            &quot;MemorySwappiness&quot;: -1,</div><div class="line">            &quot;OomKillDisable&quot;: false,</div><div class="line">            &quot;PidsLimit&quot;: 0,</div><div class="line">            &quot;Ulimits&quot;: null,</div><div class="line">            &quot;CpuCount&quot;: 0,</div><div class="line">            &quot;CpuPercent&quot;: 0,</div><div class="line">            &quot;IOMaximumIOps&quot;: 0,</div><div class="line">            &quot;IOMaximumBandwidth&quot;: 0</div><div class="line">        },</div><div class="line">        &quot;GraphDriver&quot;: {</div><div class="line">            &quot;Name&quot;: &quot;aufs&quot;,</div><div class="line">            &quot;Data&quot;: null</div><div class="line">        },</div><div class="line">        &quot;Mounts&quot;: [],</div><div class="line">        &quot;Config&quot;: {</div><div class="line">            &quot;Hostname&quot;: &quot;0b1e85dd85c6&quot;,</div><div class="line">            &quot;Domainname&quot;: &quot;&quot;,</div><div class="line">            &quot;User&quot;: &quot;&quot;,</div><div class="line">            &quot;AttachStdin&quot;: false,</div><div class="line">            &quot;AttachStdout&quot;: false,</div><div class="line">            &quot;AttachStderr&quot;: false,</div><div class="line">            &quot;ExposedPorts&quot;: {</div><div class="line">                &quot;5000/tcp&quot;: {}</div><div class="line">            },</div><div class="line">            &quot;Tty&quot;: false,</div><div class="line">            &quot;OpenStdin&quot;: false,</div><div class="line">            &quot;StdinOnce&quot;: false,</div><div class="line">            &quot;Env&quot;: [</div><div class="line">                &quot;PATH=/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin&quot;</div><div class="line">            ],</div><div class="line">            &quot;Cmd&quot;: [</div><div class="line">                &quot;python&quot;,</div><div class="line">                &quot;app.py&quot;</div><div class="line">            ],</div><div class="line">            &quot;Image&quot;: &quot;training/webapp&quot;,</div><div class="line">            &quot;Volumes&quot;: null,</div><div class="line">            &quot;WorkingDir&quot;: &quot;/opt/webapp&quot;,</div><div class="line">            &quot;Entrypoint&quot;: null,</div><div class="line">            &quot;OnBuild&quot;: null,</div><div class="line">            &quot;Labels&quot;: {}</div><div class="line">        },</div><div class="line">        &quot;NetworkSettings&quot;: {</div><div class="line">            &quot;Bridge&quot;: &quot;&quot;,</div><div class="line">            &quot;SandboxID&quot;: &quot;c3db19a0058cb4b91de8cd09170f1df5d88fd7ab10e2f95c3b5c8d124d49363e&quot;,</div><div class="line">            &quot;HairpinMode&quot;: false,</div><div class="line">            &quot;LinkLocalIPv6Address&quot;: &quot;&quot;,</div><div class="line">            &quot;LinkLocalIPv6PrefixLen&quot;: 0,</div><div class="line">            &quot;Ports&quot;: {</div><div class="line">                &quot;5000/tcp&quot;: [</div><div class="line">                    {</div><div class="line">                        &quot;HostIp&quot;: &quot;0.0.0.0&quot;,</div><div class="line">                        &quot;HostPort&quot;: &quot;32768&quot;</div><div class="line">                    }</div><div class="line">                ]</div><div class="line">            },</div><div class="line">            &quot;SandboxKey&quot;: &quot;/var/run/docker/netns/c3db19a0058c&quot;,</div><div class="line">            &quot;SecondaryIPAddresses&quot;: null,</div><div class="line">            &quot;SecondaryIPv6Addresses&quot;: null,</div><div class="line">            &quot;EndpointID&quot;: &quot;e2f7ed5a9fd80ee28b87efc4d22fb0877c570008136bbd690d2e9f05ceb799c0&quot;,</div><div class="line">            &quot;Gateway&quot;: &quot;172.17.0.1&quot;,</div><div class="line">            &quot;GlobalIPv6Address&quot;: &quot;&quot;,</div><div class="line">            &quot;GlobalIPv6PrefixLen&quot;: 0,</div><div class="line">            &quot;IPAddress&quot;: &quot;172.17.0.3&quot;,</div><div class="line">            &quot;IPPrefixLen&quot;: 16,</div><div class="line">            &quot;IPv6Gateway&quot;: &quot;&quot;,</div><div class="line">            &quot;MacAddress&quot;: &quot;02:42:ac:11:00:03&quot;,</div><div class="line">            &quot;Networks&quot;: {</div><div class="line">                &quot;bridge&quot;: {</div><div class="line">                    &quot;IPAMConfig&quot;: null,</div><div class="line">                    &quot;Links&quot;: null,</div><div class="line">                    &quot;Aliases&quot;: null,</div><div class="line">                    &quot;NetworkID&quot;: &quot;53a11e35ad9bc81d7bbeec10d7092c98daba6e878b361be511841c91eb720a71&quot;,</div><div class="line">                    &quot;EndpointID&quot;: &quot;e2f7ed5a9fd80ee28b87efc4d22fb0877c570008136bbd690d2e9f05ceb799c0&quot;,</div><div class="line">                    &quot;Gateway&quot;: &quot;172.17.0.1&quot;,</div><div class="line">                    &quot;IPAddress&quot;: &quot;172.17.0.3&quot;,</div><div class="line">                    &quot;IPPrefixLen&quot;: 16,</div><div class="line">                    &quot;IPv6Gateway&quot;: &quot;&quot;,</div><div class="line">                    &quot;GlobalIPv6Address&quot;: &quot;&quot;,</div><div class="line">                    &quot;GlobalIPv6PrefixLen&quot;: 0,</div><div class="line">                    &quot;MacAddress&quot;: &quot;02:42:ac:11:00:03&quot;</div><div class="line">                }</div><div class="line">            }</div><div class="line">        }</div><div class="line">    }</div></pre></td></tr></table></figure>
<p>Container names must be unique. That means you can only call one container <code>web</code>. If you want to re-use a container name you must delete the old container (with docker rm) before you can reuse the name with a new container. </p>
<p>Go ahead and stop and remove your old web container.</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">PS C:\Users\Lin&gt; docker stop web</div><div class="line">web</div><div class="line">PS C:\Users\Lin&gt; docker rm web</div><div class="line">web</div></pre></td></tr></table></figure>
<h3 id="Launch-a-container-on-the-default-network"><a href="#Launch-a-container-on-the-default-network" class="headerlink" title="Launch a container on the default network"></a>Launch a container on the default network</h3><p>Docker includes support for networking containers through the use of <strong><code>network drivers</code></strong>. By default, Docker provides two network drivers for you, the <code>bridge</code> and the <code>overlay</code> drivers. </p>
<p>You can also write a network driver plugin so that you can create your own drivers but that is an advanced task.</p>
<p>Every installation of the Docker Engine automatically includes three default networks. You can list them:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">PS C:\Users\Lin&gt; docker network ls</div><div class="line">NETWORK ID          NAME                   DRIVER              SCOPE</div><div class="line">53a11e35ad9b        bridge                 bridge              local</div><div class="line">d9e812eea871        host                   host                local</div><div class="line">69572fce975d        none                   null                local</div></pre></td></tr></table></figure>
<p>The network named <code>bridge</code> is a special network. Unless you tell it otherwise, Docker always launches your containers in this network. Try this now:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">PS C:\Users\Lin&gt; docker run -itd --name=networktest ubuntu</div><div class="line">a5d6ee19e894894210c7b50937456b433dba003d58c94c766e05d6da6aedbf19</div></pre></td></tr></table></figure>
<p>Inspecting the network is an easy way to find out the container&#x2019;s IP address.</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div></pre></td><td class="code"><pre><div class="line">PS C:\Users\Lin&gt; docker network inspect bridge</div><div class="line">[</div><div class="line">    {</div><div class="line">        &quot;Name&quot;: &quot;bridge&quot;,</div><div class="line">        &quot;Id&quot;: &quot;53a11e35ad9bc81d7bbeec10d7092c98daba6e878b361be511841c91eb720a71&quot;,</div><div class="line">        &quot;Scope&quot;: &quot;local&quot;,</div><div class="line">        &quot;Driver&quot;: &quot;bridge&quot;,</div><div class="line">        &quot;EnableIPv6&quot;: false,</div><div class="line">        &quot;IPAM&quot;: {</div><div class="line">            &quot;Driver&quot;: &quot;default&quot;,</div><div class="line">            &quot;Options&quot;: null,</div><div class="line">            &quot;Config&quot;: [</div><div class="line">                {</div><div class="line">                    &quot;Subnet&quot;: &quot;172.17.0.0/16&quot;,</div><div class="line">                    &quot;Gateway&quot;: &quot;172.17.0.1&quot;</div><div class="line">                }</div><div class="line">            ]</div><div class="line">        },</div><div class="line">        &quot;Internal&quot;: false,</div><div class="line">        &quot;Containers&quot;: {</div><div class="line">            &quot;a5d6ee19e894894210c7b50937456b433dba003d58c94c766e05d6da6aedbf19&quot;: {</div><div class="line">                &quot;Name&quot;: &quot;networktest&quot;,</div><div class="line">                &quot;EndpointID&quot;: &quot;267b729754687d9ea1af9d370620461bb6c8e9f3f7b7d4fe1a3ec6c4aa51bde7&quot;,</div><div class="line">                &quot;MacAddress&quot;: &quot;02:42:ac:11:00:03&quot;,</div><div class="line">                &quot;IPv4Address&quot;: &quot;172.17.0.3/16&quot;,</div><div class="line">                &quot;IPv6Address&quot;: &quot;&quot;</div><div class="line">            }</div><div class="line">        },</div><div class="line">        &quot;Options&quot;: {</div><div class="line">            &quot;com.docker.network.bridge.default_bridge&quot;: &quot;true&quot;,</div><div class="line">            &quot;com.docker.network.bridge.enable_icc&quot;: &quot;true&quot;,</div><div class="line">            &quot;com.docker.network.bridge.enable_ip_masquerade&quot;: &quot;true&quot;,</div><div class="line">            &quot;com.docker.network.bridge.host_binding_ipv4&quot;: &quot;0.0.0.0&quot;,</div><div class="line">            &quot;com.docker.network.bridge.name&quot;: &quot;docker0&quot;,</div><div class="line">            &quot;com.docker.network.driver.mtu&quot;: &quot;1500&quot;</div><div class="line">        },</div><div class="line">        &quot;Labels&quot;: {}</div><div class="line">    }</div><div class="line">]</div></pre></td></tr></table></figure>
<p>You can remove a container from a network by disconnecting the container. </p>
<p>To do this, you supply both the network name and the container name. You can also use the container id. In this example, though, the name is faster.</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">$ docker network disconnect bridge networktest</div></pre></td></tr></table></figure>
<p>While you can disconnect a container from a network, you cannot remove the builtin <code>bridge</code> network named <code>bridge</code>.</p>
<p>Networks are natural ways to isolate containers from other containers or other networks. So, as you get more experienced with Docker, you&#x2019;ll want to create your own networks.</p>
<h3 id="Create-your-own-bridge-network"><a href="#Create-your-own-bridge-network" class="headerlink" title="Create your own bridge network"></a>Create your own bridge network</h3><p>Docker Engine natively supports both bridge networks and overlay networks. A bridge network is limited to a single host running Docker Engine. An overlay</p>
<p>network can include multiple hosts and is a more advanced topic. For this example, you&#x2019;ll create a bridge network:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">docker network create -d bridge my-bridge-network</div></pre></td></tr></table></figure>
<p>The <code>-d</code> flag tells Docker to use the <code>bridge</code> driver for the new network. You could have left this flag off as <code>bridge</code> is the default value for this flag.</p>
<p>Go ahead and list the networks on your machine:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">PS C:\Users\Lin&gt; docker network ls</div><div class="line">NETWORK ID          NAME                   DRIVER              SCOPE</div><div class="line">4aae9306fe07        bridge                 bridge              local</div><div class="line">d9e812eea871        host                   host                local</div><div class="line">a7ad2dfdc6b9        my-bridge-network      bridge              local</div><div class="line">69572fce975d        none                   null                local</div></pre></td></tr></table></figure>
<p>If you inspect the network, you&#x2019;ll find that it has nothing in it.</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div></pre></td><td class="code"><pre><div class="line">PS C:\Users\Lin&gt; docker network inspect my-bridge-network</div><div class="line">[</div><div class="line">    {</div><div class="line">        &quot;Name&quot;: &quot;my-bridge-network&quot;,</div><div class="line">        &quot;Id&quot;: &quot;a7ad2dfdc6b90388611ed21570f8f0bd3a37a864c77a9354f5a4f7c484194994&quot;,</div><div class="line">        &quot;Scope&quot;: &quot;local&quot;,</div><div class="line">        &quot;Driver&quot;: &quot;bridge&quot;,</div><div class="line">        &quot;EnableIPv6&quot;: false,</div><div class="line">        &quot;IPAM&quot;: {</div><div class="line">            &quot;Driver&quot;: &quot;default&quot;,</div><div class="line">            &quot;Options&quot;: {},</div><div class="line">            &quot;Config&quot;: [</div><div class="line">                {</div><div class="line">                    &quot;Subnet&quot;: &quot;172.19.0.0/16&quot;,</div><div class="line">                    &quot;Gateway&quot;: &quot;172.19.0.1/16&quot;</div><div class="line">                }</div><div class="line">            ]</div><div class="line">        },</div><div class="line">        &quot;Internal&quot;: false,</div><div class="line">        &quot;Containers&quot;: {},</div><div class="line">        &quot;Options&quot;: {},</div><div class="line">        &quot;Labels&quot;: {}</div><div class="line">    }</div><div class="line">]</div></pre></td></tr></table></figure>
<h3 id="Add-containers-to-a-network"><a href="#Add-containers-to-a-network" class="headerlink" title="Add containers to a network"></a>Add containers to a network</h3><p>To build web applications that act in concert but do so securely, create a network. Networks, by definition, provide complete isolation for containers. </p>
<p>You can add containers to a network when you first run a container.</p>
<p>Launch a container running a PostgreSQL database and pass it the <code>--network=my-bridge-network</code> flag to connect it to your new network:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">docker run -d --network=my-bridge-network --name db training/postgres</div></pre></td></tr></table></figure>
<p>If you inspect your <code>my-bridge-network</code> you&#x2019;ll see it has a container attached. You can also inspect your container to see where it is connected:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">PS C:\Users\Lin&gt;  docker inspect --format=&apos;{{json .NetworkSettings.Networks}}&apos;  db</div><div class="line">{&quot;my-bridge-network&quot;:{&quot;IPAMConfig&quot;:null,&quot;Links&quot;:null,&quot;Aliases&quot;:[&quot;3ad8df7c2409&quot;],&quot;NetworkID&quot;:&quot;a7ad2dfdc6b90388611ed21570f8f0bd3a37a864c77a9354f5a4f7c484194994&quot;,&quot;EndpointID&quot;:&quot;b14e57c7363ec94d5d0cd3</div><div class="line">516ed4251754e8cfeefb00d40e7584c93cad0a448a&quot;,&quot;Gateway&quot;:&quot;172.19.0.1&quot;,&quot;IPAddress&quot;:&quot;172.19.0.2&quot;,&quot;IPPrefixLen&quot;:16,&quot;IPv6Gateway&quot;:&quot;&quot;,&quot;GlobalIPv6Address&quot;:&quot;&quot;,&quot;GlobalIPv6PrefixLen&quot;:0,&quot;MacAddress&quot;:&quot;02:42:ac</div><div class="line">:13:00:02&quot;}}</div></pre></td></tr></table></figure>
<p>Now, go ahead and start your by now familiar web application. This time leave off the <code>-P</code> flag and also don&#x2019;t specify a network.</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">docker run -d --name web training/webapp python app.py</div></pre></td></tr></table></figure>
<p>Which network is your <code>web</code> application running under? Inspect the application and you&#x2019;ll find it is running in the default <code>bridge</code> network.</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">PS C:\Users\Lin&gt; docker inspect --format=&apos;{{json .NetworkSettings.Networks}}&apos;  web</div><div class="line">{&quot;bridge&quot;:{&quot;IPAMConfig&quot;:null,&quot;Links&quot;:null,&quot;Aliases&quot;:null,&quot;NetworkID&quot;:&quot;4aae9306fe07a2d02776b7222276bbc7d9d00c4e5c6417150e9dc11fc3a60d2c&quot;,&quot;EndpointID&quot;:&quot;9214ac81eda9797322cad7051099f4d117852edeca589</div><div class="line">2e42cfde006af024744&quot;,&quot;Gateway&quot;:&quot;172.17.0.1&quot;,&quot;IPAddress&quot;:&quot;172.17.0.3&quot;,&quot;IPPrefixLen&quot;:16,&quot;IPv6Gateway&quot;:&quot;&quot;,&quot;GlobalIPv6Address&quot;:&quot;&quot;,&quot;GlobalIPv6PrefixLen&quot;:0,&quot;MacAddress&quot;:&quot;02:42:ac:11:00:03&quot;}}</div></pre></td></tr></table></figure>
<p>Then, get the IP address of your <code>web</code></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">PS C:\Users\Lin&gt; docker inspect --format=&apos;{{range .NetworkSettings.Networks}}{{.IPAddress}}{{end}}&apos; web</div><div class="line">172.17.0.3</div></pre></td></tr></table></figure>
<p>Now, open a shell to your running <code>db</code> container:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">PS C:\Users\Lin&gt; docker exec -it db bash</div><div class="line">root@3ad8df7c2409:/# ping 172.17.0.3</div><div class="line">PING 172.17.0.3 (172.17.0.3) 56(84) bytes of data.</div><div class="line">^C</div><div class="line">--- 172.17.0.3 ping statistics ---</div><div class="line">9 packets transmitted, 0 received, 100% packet loss, time 8001ms</div></pre></td></tr></table></figure>
<p>After a bit, use <code>CTRL-C</code> to end the ping and you&#x2019;ll find the <code>ping</code> failed. That is because the two containers are running on different networks. You can fix that. Then, use the <code>exit</code> command to close the container.</p>
<p>Docker networking allows you to attach a container to as many networks as you like. You can also attach an already running container. </p>
<p>Go ahead and attach your running <code>web</code> app to the <code>my-bridge-network</code>.</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">docker network connect my-bridge-network web</div></pre></td></tr></table></figure>
<p>Open a shell into the <code>db</code> application again and try the ping command. This time just use the container name <code>web</code> rather than the IP Address.</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div></pre></td><td class="code"><pre><div class="line">PS C:\Users\Lin&gt; docker exec -it db bash</div><div class="line">root@3ad8df7c2409:/# ping web</div><div class="line">PING web (172.19.0.3) 56(84) bytes of data.</div><div class="line">64 bytes from web.my-bridge-network (172.19.0.3): icmp_seq=1 ttl=64 time=0.079 ms</div><div class="line">64 bytes from web.my-bridge-network (172.19.0.3): icmp_seq=2 ttl=64 time=0.047 ms</div><div class="line">64 bytes from web.my-bridge-network (172.19.0.3): icmp_seq=3 ttl=64 time=0.054 ms</div><div class="line">64 bytes from web.my-bridge-network (172.19.0.3): icmp_seq=4 ttl=64 time=0.048 ms</div><div class="line">64 bytes from web.my-bridge-network (172.19.0.3): icmp_seq=5 ttl=64 time=0.045 ms</div><div class="line">64 bytes from web.my-bridge-network (172.19.0.3): icmp_seq=6 ttl=64 time=0.080 ms</div><div class="line">^C</div><div class="line">--- web ping statistics ---</div><div class="line">6 packets transmitted, 6 received, 0% packet loss, time 4995ms</div><div class="line">rtt min/avg/max/mdev = 0.045/0.058/0.080/0.017 ms</div></pre></td></tr></table></figure>
<p>The <code>ping</code> shows it is contacting a different IP address, the address on the <code>my-bridge-network</code> which is different from its address on the <code>bridge</code> network.</p>
</div></article></div></section><footer><div class="paginator"><a href="/2016/08/18/build-your-own-images/" class="next">下一篇</a></div><div id="disqus_thread"></div><script>var disqus_shortname = 'chihkang';
var disqus_identifier = '2016/08/31/containers/';
var disqus_title = 'Network containers';
var disqus_url = 'https://chihkang.github.io/2016/08/31/containers/';
(function() {
    var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
    dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
    (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
})();</script><script id="dsq-count-scr" src="//chihkang.disqus.com/count.js" async></script><div class="copyright"><p>Powered by Hexo and Theme by <a href="https://github.com/pinggod/hexo-theme-apollo">apollo</a> © 2015 - 2016 <a href="https://chihkang.github.io">ChihKang Lin</a></p></div></footer></div><script async src="//cdn.bootcss.com/mathjax/2.6.1/MathJax.js?config=TeX-MML-AM_CHTML"></script></body></html>